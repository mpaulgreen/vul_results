# Vulnerability Analysis Report for CVE-2020-8565
> **Container Analyzed:** `registry.redhat.io/openshift4/ingress-node-firewall-rhel9:sha256:8f5cd20dcd28322a2bdd64ec0ba52df13ced12b717ad44d5ec62b9709a09d27d`


> **Status:** <span style='color:#F44336'>Exploitable</span>
## CVE-2020-8565 
> GHSA-ID: GHSA-8cfg-vx93-jvxw <a name='cve-intro' id='cve-intro'></a>


 In Kubernetes, if the logging level is set to at least 9, authorization and bearer tokens will be written to log files. This can occur both in API server logs and client tool output like kubectl. This affects <= v1.19.5, <= v1.18.13, <= v1.17.15, < v1.20.0-alpha2. <sup>[references](#ref)</sup> 


### Severity and CVSS Score
| Source     | Severity  | CVSS Score | Vector | Published At | Last Updated |
|---|---|---|---|---|---|
| [**GHSA**](https://github.com/advisories/GHSA-8cfg-vx93-jvxw) |MEDIUM|4.7|CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N|2023-02-06|2024-05-20
| [**NVD**](https://nvd.nist.gov/vuln/detail/None) |N/A|N/A|N/A|N/A|N/A|
| [**RHSA**](https://access.redhat.com/security/cve/CVE-2020-8565) |MODERATE|5.3|CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N|2020-10-14|N/A|
| [**Ubuntu**](https://ubuntu.com/security/CVE-2020-8565) |MEDIUM|5.5|CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N|2020-12-07|2024-07-24|
 

### EPSS Score
| EPSS | Percentile |
| --- | --- |
| 0.00044 | 0.14476 |

## Vulnerability Analysis

### Summary <a name='summary' id='summary'></a>(<span style='color:#F44336'>Exploitable</span>)
Based on the provided Checklist and Findings, the CVE is exploitable. Specifically, Checklist Item 3 reveals that logs are regularly rotated and retained for a period of 28 days, which could allow an attacker to access sensitive information if they gain access to the logs. Additionally, Checklist Item 4 indicates that it is unclear whether the logging configuration is set up to prevent the logging of sensitive information, suggesting a potential vulnerability.

### Justification <a name='justification' id='justification'></a> 


>label: vulnerable

The analysis indicates that the CVE is exploitable, as the logging configuration may allow an attacker to access sensitive information, and there is uncertainty about whether the logging setup prevents the logging of sensitive data.
### Checklist <a name='checklist-toc' id='checklist-toc'></a>
1. [Verify Logging Level](#checklist-step-1)

2. [Assess Log File Access](#checklist-step-2)

3. [Review Log Rotation and Retention](#checklist-step-3)

4. [Inspect API Server and Client Tool Output](#checklist-step-4)


## Checklist Details <a name='checklist' id='checklist'></a>

## Step 1 <a name='checklist-step-1' id='checklist-step-1'></a> : Verify Logging Level


> **Input**: *Verify Logging Level: Check the logging level configuration within the Kubernetes environment. Is the logging level set to at least 9, which would allow authorization and bearer tokens to be written to log files?*

> **Response**: *I do not have a definitive answer for this checklist item.*

[back to top](#checklist-toc)

## Step 2 <a name='checklist-step-2' id='checklist-step-2'></a> : Assess Log File Access


> **Input**: *Assess Log File Access: Evaluate who has access to the log files where authorization and bearer tokens might be written. Are these logs accessible to unauthorized personnel or are they properly restricted?*

> **Response**: *The container image's logging configuration uses structured logging, but the documentation does not provide information on how to access log files. The container image uses the Zap logging library for logging purposes, but it does not provide information about log file access management. There is no information provided about specific users or groups having access to log files. The provided context only defines ClusterRoles for viewing and editing ingress node firewall configurations, but does not mention log files or access to them.*

[back to top](#checklist-toc)

## Step 3 <a name='checklist-step-3' id='checklist-step-3'></a> : Review Log Rotation and Retention


> **Input**: *Review Log Rotation and Retention: Investigate the log rotation and retention policies in place. Are logs regularly rotated and retained for a period that could allow an attacker to access sensitive information if they gain access to the logs?*

> **Response**: *The container image uses the `zap` logging library, which is integrated with `lumberjack` for log rotation. The log rotation and retention policies are set using the `lumberjack` package, with a maximum log file size of 500 megabytes, a maximum number of backup log files of 3, and a maximum age of log files of 28 days.*

[back to top](#checklist-toc)

## Step 4 <a name='checklist-step-4' id='checklist-step-4'></a> : Inspect API Server and Client Tool Output


> **Input**: *Inspect API Server and Client Tool Output: Check if the API server logs and client tool output like kubectl are properly configured to prevent the logging of sensitive information. Are there any mechanisms in place to redact or mask sensitive data in logs?*

> **Response**: *The container image uses the Zap logging library, but it is unclear whether the logging configuration is set up to prevent the logging of sensitive information.*

[back to top](#checklist-toc)

---
## References <a name='ref' id='ref'></a>  
Here are key references for further details on this vulnerability:
- https://github.com/kubernetes/client-go/commit/e8f871a2e5fadf90fc114565abc0963967f1a373
- https://www.cve.org/CVERecord?id=CVE-2020-8565
- https://pkg.go.dev/vuln/GO-2021-0064
- https://github.com/advisories/GHSA-8cfg-vx93-jvxw
- https://github.com/kubernetes/client-go/commit/19875a3d5a2e0d4f51c976a9e0662de3c2c011e3
- https://github.com/kubernetes/client-go/commit/44e1a07f2d513e375c4b6ee6e890040b47befe86
- https://github.com/kubernetes/kubernetes/pull/95316
- https://github.com/kubernetes/kubernetes/commit/e99df0e5a75eb6e86123b56d53e9b7ca0fd00419
- https://github.com/kubernetes/client-go/commit/1b8383fc150c9b816b0072032cca75754c2734d0
- https://nvd.nist.gov/vuln/detail/CVE-2020-8565
- https://github.com/kubernetes/kubernetes/issues/95623
- https://groups.google.com/g/kubernetes-announce/c/ScdmyORnPDk
- https://groups.google.com/g/kubernetes-security-discuss/c/vm-HcrFUOCs/m/36utxAM5CwAJ

[back to top](#cve-intro)
